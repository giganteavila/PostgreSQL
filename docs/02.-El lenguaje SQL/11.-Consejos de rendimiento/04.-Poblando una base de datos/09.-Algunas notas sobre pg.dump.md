Los scripts de volteo generados por pg.dump aplican automáticamente varias de las directrices anteriores, pero no todas. Para restaurar un basurero de pgád lo más rápido posible, es necesario hacer algunas cosas adicionales  manualmente. (Tenga en cuenta que estos puntos se aplican mientras *se restaura* un verdor, no mientras se *crea*. Los mismos puntos se aplican si cargar un volcado de texto con psql o usar pg-restore para cargar desde un archivo de archivo pg.dump.)

Por defecto, pg.dump utiliza `COPY`, y cuando está generando un completo vertecado de esquema y datos, se  cuidada de cargar datos antes de crear índices y claves extranjeras. Así que en este caso varias directrices se manejan automáticamente. Lo que  te queda por hacer es:

- Establecer valores apropiados (es decir, más grandes de lo normal) para  `maintenance_work_mem`y `max_wal_size`.
- Si usas el archivo WAL o la replicación en la transmisión,  considere desactivarlos durante la restauración. Para hacer eso,  establecido  `archive_mode`a `off`,  `wal_level`a `minimal`, y  `max_wal_senders`a cero antes de cargar el versura. Después, volví a los valores correctos y toma una nueva copia de seguridad de base.
- Experimente con el volcado paralelo y los modos de restauración tanto de pg.dump como de pg-restore y encuentre el número óptimo de trabajos simultáneos a utilizar. Desecho y restauración en paralelo por medio de la  `-j`opción debe darle un rendimiento significativamente mayor sobre el modo serie.
- Considere si todo el versiero debe ser restaurado como una sola transacción. Para hacer eso, pase el  `-1`o o  `--single-transaction`opción de línea de comandos para psql o pg.restore. Cuando se utiliza este modo, incluso el más pequeño de los errores  revertirá toda la restauración, posiblemente desechando muchas horas de  procesamiento. Dependiendo de lo interrelacionadas que estén los datos,  eso podría parecer preferible a la limpieza manual, o no.  `COPY`Los comandos se ejecutarán más rápido si utilizas una sola transacción y tienes el archivo WAL apagado.
- Si varias CPUs están disponibles en el servidor de base de datos, considere el uso de pg.restore 's  `--jobs`opción. Esto permite la carga de datos y la creación de índices simultáneos.
- Corre  `ANALYZE`después.

Un verdor solo de datos seguirá utilizándose `COPY`, pero no baja ni recrea índices, y normalmente no toca las teclas extranjeras. [[14\]](https://www.postgresql.org/docs/current/populate.html#ftn.id-1.5.13.7.11.4.2) Así que al cargar un volcado solo con datos, depende de ti caer y  recrear índices y claves extranjeras si deseas usar esas técnicas.  Todavía es útil aumentar  `max_wal_size`mientras cargan los datos, pero no molestes en aumentar `maintenance_work_mem`; más bien, harías eso mientras recreas manualmente índices y claves extranjeras después. Y no te olvides de  `ANALYZE`cuando haya terminado; vea [la Sección 25.1.3](https://www.postgresql.org/docs/current/routine-vacuuming.html#VACUUM-FOR-STATISTICS) y [la Sección 25.1.6](https://www.postgresql.org/docs/current/routine-vacuuming.html#AUTOVACUUM) para más información.